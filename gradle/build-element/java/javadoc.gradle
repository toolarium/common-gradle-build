/*
 * javadoc.gradle
 *
 * Copyright by toolarium, all rights reserved.
 * MIT License: https://mit-license.org
 */

 apply plugin: 'java'


/***************************************************************************************
 * Build javadoc jar file
 ***************************************************************************************/
task javadocJar(type: Jar) {
	group = 'Build'
	description = 'Assembles the javadoc into a jar file'
	from javadoc
	archiveClassifier = 'javadoc'
	
	if (JavaVersion.current().isJava8Compatible()) {
		allprojects {
			tasks.withType(Javadoc) {
				options.addStringOption('Xdoclint:none', '-quiet')
			}
		}
	}

	if (JavaVersion.current().isJava9Compatible()) {
		allprojects {
			tasks.withType(Javadoc) {
				options.addBooleanOption('html5', true)
			}
		}
	}	
	
	// include readme, license and version files
	into 'META-INF', {
		//from "${readmeFile}"  // 'README.md'
		from "${licenseFile}" // 'LICENSE'
		from "${versionFile}" // 'VERSION'
	}

	// define proper manifest
	manifest {
		attributes 	'Specification-Title'   : rootProject.name,
					'Specification-Version' : project.version,
					'Implementation-Title'  : rootProject.name,
					'Implementation-Version': project.version + project.ext.scmVersionNumber,
					'Built-By'			   	: System.properties['user.name'],
					'Build-Timestamp'	   	: BUILD_TIMESTAMP,
					'Created-By'		   	: "Gradle ${gradle.gradleVersion}",
					'Build-JDK'			   	: "${System.properties['java.version']} (${System.properties['java.vendor']} ${System.properties['java.vm.version']})",
					'Build-OS'			   	: "${System.properties['os.name']} (${System.properties['os.version']}), ${System.properties['os.arch']}"
	}	
}
